Refactor codebase with Z [kGvJ2B] line 3.2
